<div class="banner-show" style="background-image: linear-gradient(-225deg, rgba(0,100,183,0.5) 100%, rgba(0,30,100,0.7) 53%), url(<%= image_path "background.jpg"%>);">
  <div class="banner-content">
    <h1>
      <%= @flat.name %>
    </h1>
      <%= link_to "Back to all flats", flats_path, class: "btn btn-primary" %>
  </div>
</div>


<div class="warapper-main">
  <div class="wrapper-description-book">


    <div class="description-flat">
      <h5>
        <%= @flat.description %>
      </h5>
      <h5>
        <%= @flat.location %>
      </h5>
      <p>
        <%= @flat.price %>€ per night
      </p>
    </div>


    <div class="book-flat">
      <%= simple_form_for [@flat, @booking], input_html: { id: "flat-form"} do |f| %>
        <%= f.input :start_date, as: :date, html5: true  %>
        <%= f.input :end_date, as: :date, html5: true  %>
        <%= f.input :description %>
          <div id="total-price">
          </div>
        <%= f.button :submit, class: "btn btn-primary" %>
        <% #(start_date..end_date).to_a.size  %>

      <% end %>
    </div>

    <script>
      const form = document.getElementById('new_booking');
      const displayResult = document.getElementById("total-price");

      form.addEventListener("change", function(event) {
        let start = document.getElementById('booking_start_date').value;
        let end = document.getElementById('booking_end_date').value;

          let dateStart = new Date(start);
          let dateEnd = new Date(end);
          let timeDiff = Math.abs(dateEnd.getTime() - dateStart.getTime());
          let diffDays = Math.ceil(timeDiff / (1000 * 3600 * 24));

          console.log(diffDays);
          const reg = /^\d+$/;
          if (Number.isInteger(diffDays)) {
            console.log('diff days is right');
            let totalPrice = diffDays * <%= @flat.price %>;
            displayResult.insertAdjacentHTML("beforeend", 'Total price: ' + totalPrice + '€');
          }

       });
    </script>
  </div>
</div>
